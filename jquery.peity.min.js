!function(t,i,e,n){var a=t.fn.peity=function(i,e){return l&&this.each(function(){var n=t(this),h=n.data("_peity");h?(i&&(h.type=i),t.extend(h.opts,e)):(h=new r(n,i,t.extend({},a.defaults[i],n.data("peity"),e)),n.change(function(){h.draw()}).data("_peity",h)),h.draw()}),this},r=function(t,i,e){this.$el=t,this.type=i,this.opts=e},h=r.prototype,s=h.svgElement=function(e,n){return t(i.createElementNS("http://www.w3.org/2000/svg",e)).attr(n)},l="createElementNS"in i&&s("svg",{})[0].createSVGRect;h.draw=function(){var t=this.opts;a.graphers[this.type].call(this,t),t.after&&t.after.call(this,t)},h.fill=function(){var i=this.opts.fill;return t.isFunction(i)?i:function(t,e){return i[e%i.length]}},h.prepare=function(t,i){return this.$svg||this.$el.hide().after(this.$svg=s("svg",{class:"peity"})),this.$svg.empty().data("_peity",this).attr({height:i,width:t})},h.values=function(){return t.map(this.$el.text().split(this.opts.delimiter),function(t){return parseFloat(t)})},a.defaults={},a.graphers={},a.register=function(t,i,e){this.defaults[t]=i,this.graphers[t]=e},a.register("pie",{fill:["#ff9900","#fff4dd","#ffc66e"],radius:8},function(i){if(!i.delimiter){var n=this.$el.text().match(/[^0-9\.]/);i.delimiter=n?n[0]:","}var a=t.map(this.values(),function(t){return t>0?t:0});if("/"==i.delimiter){var r=a[0],h=a[1];a=[r,e.max(0,h-r)]}for(var l=0,p=a.length,u=0;l<p;l++)u+=a[l];u||(p=2,u=1,a=[0,1]);var o=2*i.radius,f=i.width||o,c=i.height||o,d=this.prepare(f,c),g=f/2,v=c/2,m=e.min(g,v),y=i.innerRadius;"donut"!=this.type||y||(y=.5*m);var w=e.PI,x=this.fill(),k=this.scale=function(t,i){var n=t/u*w*2-w/2;return[i*e.cos(n)+g,i*e.sin(n)+v]},$=0;for(l=0;l<p;l++){var j,A=a[l],E=A/u;if(0!=E){if(1==E)if(y){var F=g-.01,M=v-m,S=v-y;j=s("path",{d:["M",g,M,"A",m,m,0,1,1,F,M,"L",F,S,"A",y,y,0,1,0,g,S].join(" "),"data-value":A})}else j=s("circle",{cx:g,cy:v,"data-value":A,r:m});else{var _=$+A,L=["M"].concat(k($,m),"A",m,m,0,E>.5?1:0,1,k(_,m),"L");y?L=L.concat(k(_,y),"A",y,y,0,E>.5?1:0,0,k($,y)):L.push(g,v),$+=A,j=s("path",{d:L.join(" "),"data-value":A})}j.attr("fill",x.call(this,A,l,a)),d.append(j)}}}),a.register("donut",t.extend(!0,{},a.defaults.pie),function(t){a.graphers.pie.call(this,t)}),a.register("line",{delimiter:",",fill:"#c6d9fd",height:16,min:0,stroke:"#4d89f9",strokeWidth:1,width:32},function(t){var i=this.values();1==i.length&&i.push(i[0]);for(var n=e.max.apply(e,null==t.max?i:i.concat(t.max)),a=e.min.apply(e,null==t.min?i:i.concat(t.min)),r=this.prepare(t.width,t.height),h=t.strokeWidth,l=r.width()||t.width,p=(r.height()||t.height)-h,u=n-a,o=this.x=function(t){return t*(l/(i.length-1))},f=this.y=function(t){var i=p;return u&&(i-=(t-a)/u*p),i+h/2},c=f(e.max(a,0)),d=[0,c],g=0;g<i.length;g++)d.push(o(g),f(i[g]));d.push(l,c),t.fill&&r.append(s("polygon",{fill:t.fill,points:d.join(" ")})),h&&r.append(s("polyline",{fill:"none",points:d.slice(2,d.length-2).join(" "),stroke:t.stroke,"stroke-width":h,"stroke-linecap":"square"}))}),a.register("bar",{delimiter:",",fill:["#4D89F9"],height:16,min:0,padding:.1,width:32},function(t){for(var i=this.values(),n=e.max.apply(e,null==t.max?i:i.concat(t.max)),a=e.min.apply(e,null==t.min?i:i.concat(t.min)),r=this.prepare(t.width,t.height),h=r.width()||t.width,l=r.height()||t.height,p=n-a,u=t.padding,o=this.fill(),f=this.x=function(t){return t*h/i.length},c=this.y=function(t){return l-(p?(t-a)/p*l:1)},d=0;d<i.length;d++){var g,v=f(d+u),m=f(d+1-u)-v,y=i[d],w=c(y),x=w,k=w;p?y<0?x=c(e.min(n,0)):k=c(e.max(a,0)):g=1,0==(g=k-x)&&(g=1,n>0&&p&&x--),r.append(s("rect",{"data-value":y,fill:o.call(this,y,d,i),x:v,y:x,width:m,height:g}))}})}(jQuery,document,Math);